/+  *test, *lm, lv
::
::::
  ::
=/  rtol  .1e-6
|%
::  Auxiliary tools
::    Absolute value
++  absolute
  |=  x=@rs  ^-  @rs
  ?:  (gth:rs x .0)  x
  (sub:rs .0 x)
::    Closeness of two matrices
++  all-close  ^+  %.y
|=  [u=@lms v=@lms]  ^-  @rd
  =/  n  `@ud`(length u)
  =/  count  0
  =/  off  0
  |-  ^-  @rd
    ?:  =(count n)  =(0 off)
  $(count +(count), sum (add off `@`(isclose:lms (get u +(count)) (get v +(count)))))
  :: XX TODO
::
::  Tests for matrix creation
::
++  test-zeros  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (zeros:lms 0 0)
    %+  expect-eq
      !>  `@lms`0x1000100000000
      !>  (zeros:lms 1 1)
    %+  expect-eq
      !>  (make:lms ~[~[.0]])
      !>  (zeros:lms 1 1)
    %+  expect-eq
      !>  `@lms`0x30003000000000000000000000000000000000000000000000000000000000000000000000000
      !>  (zeros:lms 3 3)
    %+  expect-eq
      !>  (make:lms ~[~[.0 .0 .0] ~[.0 .0 .0] ~[.0 .0 .0]])
      !>  (zeros:lms 3 3)
    %+  expect-eq
      !>  `@lms`0x5000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
      !>  (zeros:lms 5 5)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .0)))
      !>  (zeros:lms 5 5)
    %+  expect-eq
      !>  `@lms`0x10000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
      !>  (zeros:lms 12 16)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .0)))
      !>  (zeros:lms 16)
  ==
++  test-ones  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (ones:lms 0 0)
    %+  expect-eq
      !>  `@lms`0x100013f800000
      !>  (ones:lms 1 1)
    %+  expect-eq
      !>  (make:lms ~[~[.1]])
      !>  (ones:lms 1 1)
    %+  expect-eq
      !>  `@lms`0x300033f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (ones:lms 3 3)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1] ~[.1 .1 .1] ~[.1 .1 .1]])
      !>  (ones:lms 3 3)
    %+  expect-eq
      !>  `@lms`0x500053f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (ones:lms 5 5)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
      !>  (ones:lms 5 5)
    %+  expect-eq
      !>  `@lms`0x10000c3f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (ones:lms 12 16)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .1)))
      !>  (ones:lms 16)
  ==
++  test-id  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x300033f8000000000000000000000000000003f8000000000000000000000000000003f800000
      !>  (id:lms 3)
    %+  expect-eq
      !>  `@lms`0xc000c3f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f800000
      !>  (id:lms 12)
  ==
++  test-fill  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (fill:lms 0 0 .0)
    %+  expect-eq
      !>  `@lms`0x0
      !>  (fill:lms 0 0 .1)
    %+  expect-eq
      !>  `@lms`0x1000100000000
      !>  (fill:lms 1 1 .0)
    %+  expect-eq
      !>  (make:lms ~[~[.0]])
      !>  (fill:lms 1 1 .0)
    %+  expect-eq
      !>  `@lms`0x100013f800000
      !>  (fill:lms 1 1 .1)
    %+  expect-eq
      !>  (make:lms ~[~[.1]])
      !>  (fill:lms 1 1 .1)
    %+  expect-eq
      !>  `@lms`0x10001bf800000
      !>  (fill:lms 1 1 .-1)
    %+  expect-eq
      !>  (make:lms ~[~[.-1]])
      !>  (fill:lms 1 1 .-1)
    %+  expect-eq
      !>  `@lms`0x300033f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (fill:lms 3 3 .1)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 3 (reap 3 .1)))
      !>  (fill:lms 3 3 .1)
    %+  expect-eq
      !>  `@lms`0x500053f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (fill:lms 5 5 .1)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
      !>  (fill:lms 5 5 .1)
  ==
++  test-make  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (make:lms 0 .0)  :: XX should fail? check how to test crash
    %+  expect-eq
      !>  `@lms`0x1000100000000
      !>  (make:lms ~[~[.0]])
    %+  expect-eq
      !>  `@lms`0x300033f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (make:lms `(list (list @rs))`(reap 3 (reap 3 .1)))
    %+  expect-eq
      !>  `@lms`0x500053f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
    %+  expect-eq
      !>  `@lms`0x10000c3f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .1)))
    %+  expect-eq
      !>  `@lms`0x100013f800000
      !>  (make:lms ~[~[.1]])
    %+  expect-eq
      !>  `@lms`0x300013f8000003f8000003f800000
      !>  (make:lms ~[~[.1 .1 .1]])
    %+  expect-eq
      !>  `@lms`0x500043f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (make:lms `(list (list @rs))`(reap 4 (reap 5 .1)))
    %+  expect-eq
      !>  `@lms`0xa00023f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (make:lms `(list (list @rs))`(reap 2 (reap 10 .1)))
    %+  expect-eq
      !>  `@lms`0x200023f800000400000004040000040800000
      !>  (make:lms ~[~[.1 .2] ~[.3 .4]])
    %+  expect-eq
      !>  `@lms`0x300033f80000040000000404000004080000040a0000040c0000040e000004100000041100000
      !>  (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]])
    %+  expect-eq
      !>  `@lms`0x80003c0400000c0000000bf800000000000003f800000400000004040000040800000c0800000c0400000c0000000bf800000000000003f8000004000000040400000c0a00000c0800000c0400000c0000000bf800000000000003f80000040000000
      !>  (make:lms ~[~[.-3 .-2 .-1 .0 .1 .2 .3 .4] ~[.-4 .-3 .-2 .-1 .0 .1 .2 .3] ~[.-5 .-4 .-3 .-2 .-1 .0 .1 .2]])
  ==
++  test-unmake  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `(list (list @rs))`~  :: XX should fail? check how to test crash
      !>  (unmake:lms `@lms`0x0)
    %+  expect-eq
      !>  ~[~[.0]]
      !>  (unmake:lms `@lms`0x1000100000000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 3 (reap 3 .1))
      !>  (unmake:lms `@lms`0x300033f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 5 (reap 5 .1))
      !>  (unmake:lms `@lms`0x500053f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 12 (reap 16 .1))
      !>  (unmake:lms `@lms`0x10000c3f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000)
    %+  expect-eq
      !>  ~[~[.1]]
      !>  (unmake:lms `@lms`0x100013f800000)
    %+  expect-eq
      !>  ~[~[.1 .1 .1]]
      !>  (unmake:lms `@lms`0x300013f8000003f8000003f800000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 4 (reap 5 .1))
      !>  (unmake:lms `@lms`0x500043f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 2 (reap 10 .1))
      !>  (unmake:lms `@lms`0xa00023f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000)
    %+  expect-eq
      !>  ~[~[.1 .2] ~[.3 .4]]
      !>  (unmake:lms `@lms`0x200023f800000400000004040000040800000)
    %+  expect-eq
      !>  ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]
      !>  (unmake:lms `@lms`0x300033f80000040000000404000004080000040a0000040c0000040e000004100000041100000)
    %+  expect-eq
      !>  ~[~[.-3 .-2 .-1 .0 .1 .2 .3 .4] ~[.-4 .-3 .-2 .-1 .0 .1 .2 .3] ~[.-5 .-4 .-3 .-2 .-1 .0 .1 .2]]
      !>  (unmake:lms `@lms`0x80003c0400000c0000000bf800000000000003f800000400000004040000040800000c0800000c0400000c0000000bf800000000000003f8000004000000040400000c0a00000c0800000c0400000c0000000bf800000000000003f80000040000000)
  ==
++  test-make-unmake  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]
      !>  (unmake:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]))
    %+  expect-eq
      !>  `@lms`0x80003c0400000c0000000bf800000000000003f800000400000004040000040800000c0800000c0400000c0000000bf800000000000003f8000004000000040400000c0a00000c0800000c0400000c0000000bf800000000000003f80000040000000
      !>  (make:lms (unmake:lms `@lms`0x80003c0400000c0000000bf800000000000003f800000400000004040000040800000c0800000c0400000c0000000bf800000000000003f8000004000000040400000c0a00000c0800000c0400000c0000000bf800000000000003f80000040000000))
  ==
::
::  Tests for utility functions
::
++  test-shape  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `(list @ud)`~[3 3]
      !>  (shape:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]))
    %+  expect-eq
      !>  `(list @ud)`~[2 3]
      !>  (shape:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6]]))
    %+  expect-eq
      !>  `(list @ud)`~[3 2]
      !>  (shape:lms (make:lms ~[~[.1 .2] ~[.4 .5] ~[.7 .8]]))
  ==
++  test-get  !!
++  test-getc  !!
++  test-getr  !!
::
::  Tests for matrix alteration
::
++  test-set  !!
++  test-setc  !!
++  test-setr  !!
++  test-swapc  !!
++  test-swapr  !!
++  test-trans  !!
::
::  Tests for matrix arithmetic
::
++  test-adds  !!
++  test-subs  !!
++  test-muls  !!
++  test-divs  !!
++  test-addsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.6 .6 .7 .8 .9] ~[.1e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.4e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
    %+  expect-eq
      !>  `@lms`0x500044000000040000000404000004080000040a0000040c0000040c0000040e00000410000004110000041200000412000004130000041400000415000004160000041600000417000004180000041880000
      !>  (addsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
  ==
++  test-subsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .2 .3 .4 .5] ~[.4 .6 .7 .8 .9] ~[.8 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.2e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
    %+  expect-eq
      !>  `@lms`0x500040000000040000000404000004080000040a000004080000040c0000040e00000410000004110000041000000412000004130000041400000415000004140000041600000417000004180000041880000
      !>  (subsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
  ==
++  test-mulsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.1e1 .6 .7 .8 .9] ~[.1.8e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.2.6e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
    %+  expect-eq
      !>  `@lms`0x500044000000040000000404000004080000040a000004120000040c0000040e000004100000041100000419000004120000041300000414000004150000041d0000041600000417000004180000041880000
      !>  (mulsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
  ==
++  test-divsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.5e-1 .2 .3 .4 .5] ~[.2.5 .6 .7 .8 .9] ~[.4.5 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.6.5 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
    %+  expect-eq
      !>  `@lms`0x500043f00000040000000404000004080000040a000004020000040c0000040e000004100000041100000409000004120000041300000414000004150000040d0000041600000417000004180000041880000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
  ==
++  test-addsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.8e1 .1.9e1 .2e1 .2.1e1 .2.2e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e0000041000000411000004110000041200000413000004140000041500000419000004198000041a0000041a8000041b00000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-subsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.8 .9 .1e1 .1.1e1 .1.2e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004100000041100000412000004130000041400000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-mulsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.6.5e1 .7e1 .7.5e1 .8e1 .8.5e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e000004100000041100000411000004120000041300000414000004150000042820000428c00004296000042a0000042aa0000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-divsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.2.6 .2.8 .3 .3.1999998 .3.3999999]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e0000041000000411000004110000041200000413000004140000041500000402666664033333340400000404ccccc40599999
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-addvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.7 .6 .7 .8 .9] ~[.1.2e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.7e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x500044000000040000000404000004080000040a0000040e0000040c0000040e00000410000004110000041400000412000004130000041400000415000004188000041600000417000004180000041880000
      !>  (addvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .5 .5] ~[.5 .6 .7 .1e1 .9] ~[.9 .1e1 .1.1e1 .1.5e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .2e1 .1.7e1]])
      !>  (addvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x500043f800000400000004040000040a0000040a0000040a0000040c0000040e000004120000041100000411000004120000041300000417000004150000041500000416000004170000041a0000041880000
      !>  (addvc:lms mr 4 vc)
    ==
++  test-subvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .2 .3 .4 .5] ~[.3 .6 .7 .8 .9] ~[.6 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.9 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x500040000000040000000404000004080000040a000004040000040c0000040e00000410000004110000040c00000412000004130000041400000415000004110000041600000417000004180000041880000
      !>  (subvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .3 .5] ~[.5 .6 .7 .6 .9] ~[.9 .1e1 .1.1e1 .9 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.2e1 .1.7e1]])
      !>  (subvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004040000040a0000040a0000040c0000040e0000040c000004110000041100000412000004130000041100000415000004150000041600000417000004140000041880000
      !>  (subvc:lms mr 4 vc)
  ==
++  test-mulvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.1e1 .6 .7 .8 .9] ~[.2.7e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.5.2e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a000004120000040c0000040e00000410000004110000041d80000412000004130000041400000415000004250000041600000417000004180000041880000
      !>  (mulvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .1.6e1 .9] ~[.9 .1e1 .1.1e1 .3.6e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .6.4e1 .1.7e1]])
      !>  (mulvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e00000418000004110000041100000412000004130000042100000415000004150000041600000417000004280000041880000
      !>  (mulvc:lms mr 4 vc)
  ==
++  test-divvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.2.5 .6 .7 .8 .9] ~[.3 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.3.25 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a000004020000040c0000040e00000410000004110000040400000412000004130000041400000415000004050000041600000417000004180000041880000
      !>  (divvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .4 .9] ~[.9 .1e1 .1.1e1 .4 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .4 .1.7e1]])
      !>  (divvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e00000408000004110000041100000412000004130000040800000415000004150000041600000417000004080000041880000
      !>  (divvc:lms mr 4 vc)
  ==
++  test-addvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .-1 .-2 .-3 .-4] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x5000400000000bf800000c0000000c0400000c080000040a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004150000041600000417000004180000041880000
      !>  (addvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.2e1 .1.1e1 .1e1 .9 .8]])
      !>  (addvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004140000041300000412000004110000041000000
      !>  (addvr:lms mr 4 vr)
  ==
++  test-subvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .5 .8 .1.1e1 .1.4e1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x500044000000040a0000041000000413000004160000040a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004150000041600000417000004180000041880000
      !>  (subvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.4e1 .1.7e1 .2e1 .2.3e1 .2.6e1]])
      !>  (subvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e0000041000000411000004110000041200000413000004140000041500000416000004188000041a0000041b8000041d00000
      !>  (subvr:lms mr 4 vr)
  ==
++  test-mulvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.-1 .-6 .-1.5e1 .-2.8e1 .-4.5e1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x50004bf800000c0c00000c1700000c1e00000c234000040a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004150000041600000417000004180000041880000
      !>  (mulvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.-1.3e1 .-4.2e1 .-7.5e1 .-1.12e2 .-1.53e2]])
      !>  (mulvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e0000041000000411000004110000041200000413000004140000041500000c1500000c2280000c2960000c2e00000c3190000
      !>  (mulvr:lms mr 4 vr)
  ==
++  test-divvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.-1 .-6.666666e-1 .-5.9999996e-1 .-5.7142854e-1 .-5.555555e-1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x50004bf800000bf2aaaaabf199999bf124924bf0e38e340a0000040c0000040e00000410000004110000041100000412000004130000041400000415000004150000041600000417000004180000041880000
      !>  (divvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.-1.3e1 .-4.6666665 .-3 .-2.2857141 .-1.8888888]])
      !>  (divvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x500043f80000040000000404000004080000040a0000040a0000040c0000040e0000041000000411000004110000041200000413000004140000041500000c1500000c0955555c0400000c0124924bff1c71c
      !>  (divvr:lms mr 4 vr)
  ==
++  test-addm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .4 .6 .8 .1e1] ~[.1e1 .1.2e1 .1.4e1 .1.6e1 .1.8e1] ~[.1.8e1 .2e1 .2.2e1 .2.4e1 .2.6e1] ~[.2.6e1 .2.8e1 .3e1 .3.2e1 .3.4e1]])
      !>  (addm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x50004400000004080000040c00000410000004120000041200000414000004160000041800000419000004190000041a0000041b0000041c0000041d0000041d0000041e0000041f000004200000042080000
      !>  (addm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-subm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0]])
      !>  (subm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x500040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
      !>  (subm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mulm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .4 .9 .1.6e1 .2.5e1] ~[.2.5e1 .3.6e1 .4.9e1 .6.4e1 .8.1e1] ~[.8.1e1 .1e2 .1.21e2 .1.44e2 .1.69e2] ~[.1.69e2 .1.96e2 .2.25e2 .2.56e2 .2.89e2]])
      !>  (mulm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x500043f80000040800000411000004180000041c8000041c8000042100000424400004280000042a2000042a2000042c8000042f2000043100000432900004329000043440000436100004380000043908000
      !>  (mulm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-divm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x500043f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mmul :: TODO
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x500043f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mpow  :: TODO
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x500043f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f8000003f800000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==


++  test-trace  !!
++  test-submatrix  !!
++  test-augment  !!
++  test-minor  !!

++  test-invert  !!
--
