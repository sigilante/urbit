/+  *test, *lm, lv
::
::::
  ::
=/  rtol  .1e-6
|%
::  Auxiliary tools
::    Absolute value
++  absolute
  |=  x=@rs  ^-  @rs
  ?:  (gth:rs x .0)  x
  (sub:rs .0 x)
::    Closeness of two matrices
++  all-close  ^+  %.y
|=  [u=@lms v=@lms]  ^-  @rd
  =/  n  `@ud`(length u)
  =/  count  0
  =/  off  0
  |-  ^-  @rd
    ?:  =(count n)  =(0 off)
  $(count +(count), sum (add off `@`(isclose:lms (get u +(count)) (get v +(count)))))
  :: XX TODO
::
::  Tests for matrix creation
::
++  test-zeros  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (zeros:lms 0 0)
    %+  expect-eq
      !>  `@lms`0x1.0001.0000.0000
      !>  (zeros:lms 1 1)
    %+  expect-eq
      !>  (make:lms ~[~[.0]])
      !>  (zeros:lms 1 1)
    %+  expect-eq
      !>  `@lms`0x3.0003.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000
      !>  (zeros:lms 3 3)
    %+  expect-eq
      !>  (make:lms ~[~[.0 .0 .0] ~[.0 .0 .0] ~[.0 .0 .0]])
      !>  (zeros:lms 3 3)
    %+  expect-eq
      !>  `@lms`0x5.0005.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000
      !>  (zeros:lms 5 5)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .0)))
      !>  (zeros:lms 5 5)
    %+  expect-eq
      !>  `@lms`0x10.000c.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000
      !>  (zeros:lms 12 16)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .0)))
      !>  (zeros:lms 16)
  ==
++  test-ones  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (ones:lms 0 0)
    %+  expect-eq
      !>  `@lms`0x10001.3f80.0000
      !>  (ones:lms 1 1)
    %+  expect-eq
      !>  (make:lms ~[~[.1]])
      !>  (ones:lms 1 1)
    %+  expect-eq
      !>  `@lms`0x3.0003.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (ones:lms 3 3)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1] ~[.1 .1 .1] ~[.1 .1 .1]])
      !>  (ones:lms 3 3)
    %+  expect-eq
      !>  `@lms`0x5.0005.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (ones:lms 5 5)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
      !>  (ones:lms 5 5)
    %+  expect-eq
      !>  `@lms`0x10.000c.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (ones:lms 12 16)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .1)))
      !>  (ones:lms 16)
  ==
++  test-id  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x3.0003.3f80.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.3f80.0000
      !>  (id:lms 3)
    %+  expect-eq
      !>  `@lms`0xc.000c.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.3f80.0000
      !>  (id:lms 12)
  ==
++  test-fill  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (fill:lms 0 0 .0)
    %+  expect-eq
      !>  `@lms`0x0
      !>  (fill:lms 0 0 .1)
    %+  expect-eq
      !>  `@lms`0x1.0001.0000.0000
      !>  (fill:lms 1 1 .0)
    %+  expect-eq
      !>  (make:lms ~[~[.0]])
      !>  (fill:lms 1 1 .0)
    %+  expect-eq
      !>  `@lms`0x10001.3f80.0000
      !>  (fill:lms 1 1 .1)
    %+  expect-eq
      !>  (make:lms ~[~[.1]])
      !>  (fill:lms 1 1 .1)
    %+  expect-eq
      !>  `@lms`0x10001.bf8
      !>  (fill:lms 1 1 .-1)
    %+  expect-eq
      !>  (make:lms ~[~[.-1]])
      !>  (fill:lms 1 1 .-1)
    %+  expect-eq
      !>  `@lms`0x30003.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (fill:lms 3 3 .1)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 3 (reap 3 .1)))
      !>  (fill:lms 3 3 .1)
    %+  expect-eq
      !>  `@lms`0x5.0005.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (fill:lms 5 5 .1)
    %+  expect-eq
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
      !>  (fill:lms 5 5 .1)
  ==
++  test-make  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `@lms`0x0
      !>  (make:lms 0 .0)  :: XX should fail? check how to test crash
    %+  expect-eq
      !>  `@lms`0x1.0001.0000.0000
      !>  (make:lms ~[~[.0]])
    %+  expect-eq
      !>  `@lms`0x3.0003.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms `(list (list @rs))`(reap 3 (reap 3 .1)))
    %+  expect-eq
      !>  `@lms`0x5.0005.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms `(list (list @rs))`(reap 5 (reap 5 .1)))
    %+  expect-eq
      !>  `@lms`0x10.000c.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms `(list (list @rs))`(reap 12 (reap 16 .1)))
    %+  expect-eq
      !>  `@lms`0x10001.3f80.0000
      !>  (make:lms ~[~[.1]])
    %+  expect-eq
      !>  `@lms`0x30001.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms ~[~[.1 .1 .1]])
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms `(list (list @rs))`(reap 4 (reap 5 .1)))
    %+  expect-eq
      !>  `@lms`0xa.0002.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (make:lms `(list (list @rs))`(reap 2 (reap 10 .1)))
    %+  expect-eq
      !>  `@lms`0x2.0002.3f80.0000.4000.0000.4040.0000.4080.0000.
      !>  (make:lms ~[~[.1 .2] ~[.3 .4]])
    %+  expect-eq
      !>  `@lms`0x3.0003.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.000040c000.0040e0.0000.4100.0000.4110.0000.
      !>  (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]])
    %+  expect-eq
      !>  `@lms`0x8.0003.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.4080.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.c0a0.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000
      !>  (make:lms ~[~[.-3 .-2 .-1 .0 .1 .2 .3 .4] ~[.-4 .-3 .-2 .-1 .0 .1 .2 .3] ~[.-5 .-4 .-3 .-2 .-1 .0 .1 .2]])
  ==
++  test-unmake  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `(list (list @rs))`~  :: XX should fail? check how to test crash
      !>  (unmake:lms `@lms`0x0)
    %+  expect-eq
      !>  ~[~[.0]]
      !>  (unmake:lms `@lms`0x1.0001.0000.0000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 3 (reap 3 .1))
      !>  (unmake:lms `@lms`0x3.0003.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 5 (reap 5 .1))
      !>  (unmake:lms `@lms`0x5.0005.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 12 (reap 16 .1))
      !>  (unmake:lms `@lms`0x10.000c.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  ~[~[.1]]
      !>  (unmake:lms `@lms`0x10001.3f80.0000)
    %+  expect-eq
      !>  ~[~[.1 .1 .1]]
      !>  (unmake:lms `@lms`0x30001.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 4 (reap 5 .1))
      !>  (unmake:lms `@lms`0x5.0004.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  `(list (list @rs))`(reap 2 (reap 10 .1))
      !>  (unmake:lms `@lms`0xa.0002.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000)
    %+  expect-eq
      !>  ~[~[.1 .2] ~[.3 .4]]
      !>  (unmake:lms `@lms`0x20002.3f80.0000.4000.0000.4040.0000.4080.0000)
    %+  expect-eq
      !>  ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]
      !>  (unmake:lms `@lms`0x30003.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.000040c000.0040e0.0000.4100.0000.4110.0000)
    %+  expect-eq
      !>  ~[~[.-3 .-2 .-1 .0 .1 .2 .3 .4] ~[.-4 .-3 .-2 .-1 .0 .1 .2 .3] ~[.-5 .-4 .-3 .-2 .-1 .0 .1 .2]]
      !>  (unmake:lms `@lms`0x8.0003.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.4080.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.c0a0.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000)
  ==
++  test-make-unmake  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]
      !>  (unmake:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]))
    %+  expect-eq
      !>  `@lms`0x8.0003.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.4080.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000.4040.0000.c0a0.0000.c080.0000.c040.0000.c000.0000.bf80.0000.0000.0000.3f80.0000.4000.0000
      !>  (make:lms (unmake:lms `@lms`0x80003c040.0000c000.0000.bf80,0000.0000.0000.3f80.0000.4000.0000.4040.0000.4080.0000.c080.0000.c040.0000.c000.0000.bf80,0000.0000.0000.3f80.0000.4000.0000.4040.0000.c0a0.0000.c080.0000.c040.0000.c000.0000.bf80,0000.0000.0000.3f80.0000.4000.0000))
  ==
::
::  Tests for utility functions
::
++  test-shape  ^-  tang
  ;:  weld
    %+  expect-eq
      !>  `(list @ud)`~[3 3]
      !>  (shape:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6] ~[.7 .8 .9]]))
    %+  expect-eq
      !>  `(list @ud)`~[2 3]
      !>  (shape:lms (make:lms ~[~[.1 .2 .3] ~[.4 .5 .6]]))
    %+  expect-eq
      !>  `(list @ud)`~[3 2]
      !>  (shape:lms (make:lms ~[~[.1 .2] ~[.4 .5] ~[.7 .8]]))
  ==
++  test-get  !!
++  test-getc  !!
++  test-getr  !!
::
::  Tests for matrix alteration
::
++  test-set  !!
++  test-setc  !!
++  test-setr  !!
++  test-swapc  !!
++  test-swapr  !!
++  test-trans  !!
::
::  Tests for matrix arithmetic
::
++  test-adds  !!
++  test-subs  !!
++  test-muls  !!
++  test-divs  !!
++  test-addsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.6 .6 .7 .8 .9] ~[.1e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.4e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
    %+  expect-eq
      !>  `@lms`0x5.0004.4000.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40c0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4120.0000.4120.0000.4130.0000.4140.0000.4150.0000.4160.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (addsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
  ==
++  test-subsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .2 .3 .4 .5] ~[.4 .6 .7 .8 .9] ~[.8 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.2e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
    %+  expect-eq
      !>  `@lms`0x5.0004.0000.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4080.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4100.0000.4120.0000.4130.0000.4140.0000.4150.0000.4140.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (subsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .1)
  ==
++  test-mulsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.1e1 .6 .7 .8 .9] ~[.1.8e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.2.6e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
    %+  expect-eq
      !>  `@lms`0x5.0004.4000.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4120.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4190.0000.4120.0000.4130.0000.4140.0000.4150.0000.41d0.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (mulsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
  ==
++  test-divsc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.5e-1 .2 .3 .4 .5] ~[.2.5 .6 .7 .8 .9] ~[.4.5 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.6.5 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f00.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4020.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4090.0000.4120.0000.4130.0000.4140.0000.4150.0000.40d0.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 1 .2)
  ==
++  test-addsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.8e1 .1.9e1 .2e1 .2.1e1 .2.2e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4190.0000.4198.0000.41a0.0000.41a8.0000.41b0.0000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-subsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.8 .9 .1e1 .1.1e1 .1.2e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4100.0000.4110.0000.4120.0000.4130.0000.4140.0000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-mulsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.6.5e1 .7e1 .7.5e1 .8e1 .8.5e1]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4282.0000.428c.0000.4296.0000.42a0.0000.42aa.0000
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-divsr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.2.6 .2.8 .3 .3.1999998 .3.3999999]])
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0,0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4026.6666.4033.3333.4040.0000.404c.cccc.4059.9999
      !>  (divsc:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) 4 .5)
  ==
++  test-addvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .2 .3 .4 .5] ~[.7 .6 .7 .8 .9] ~[.1.2e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.7e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.4000.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40e0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4140.0000.4120.0000.4130.0000.4140.0000.4150.0000.4188.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (addvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .5 .5] ~[.5 .6 .7 .1e1 .9] ~[.9 .1e1 .1.1e1 .1.5e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .2e1 .1.7e1]])
      !>  (addvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.40a0.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4120.0000.4110.0000.4110.0000.4120.0000.4130.0000.4170.0000.4150.0000.4150.0000.4160.0000.4170.0000.41a0.0000.4188.0000
      !>  (addvc:lms mr 4 vc)
    ==
++  test-subvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .2 .3 .4 .5] ~[.3 .6 .7 .8 .9] ~[.6 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.9 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.0000.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4040.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.40c0.0000.4120.0000.4130.0000.4140.0000.4150.0000.4110.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (subvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .3 .5] ~[.5 .6 .7 .6 .9] ~[.9 .1e1 .1.1e1 .9 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.2e1 .1.7e1]])
      !>  (subvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4040.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.40c0.0000.4110.0000.4110.0000.4120.0000.4130.0000.4110.0000.4150.0000.4150.0000.4160.0000.4170.0000.4140.0000.4188.0000
      !>  (subvc:lms mr 4 vc)
  ==
++  test-mulvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.1e1 .6 .7 .8 .9] ~[.2.7e1 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.5.2e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4120.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.41d8.0000.4120.0000.4130.0000.4140.0000.4150.0000.4250.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (mulvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .1.6e1 .9] ~[.9 .1e1 .1.1e1 .3.6e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .6.4e1 .1.7e1]])
      !>  (mulvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4180.0000.4110.0000.4110.0000.4120.0000.4130.0000.4210.0000.4150.0000.4150.0000.4160.0000.4170.0000.4280.0000.4188.0000
      !>  (mulvc:lms mr 4 vc)
  ==
++  test-divvc
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.2.5 .6 .7 .8 .9] ~[.3 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.3.25 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divvc:lms mr 1 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.4020.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4040.0000.4120.0000.4130.0000.4140.0000.4150.0000.4050.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (divvc:lms mr 1 vc)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .4 .9] ~[.9 .1e1 .1.1e1 .4 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .4 .1.7e1]])
      !>  (divvc:lms mr 4 vc)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4080.0000.4110.0000.4110.0000.4120.0000.4130.0000.4080.0000.4150.0000.4150.0000.4160.0000.4170.0000.4080.0000.4188.0000
      !>  (divvc:lms mr 4 vc)
  ==
++  test-addvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .-1 .-2 .-3 .-4] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (addvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.0000.0000.bf80.0000.c000.0000.c040.0000.c080.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4150.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (addvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.2e1 .1.1e1 .1e1 .9 .8]])
      !>  (addvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.000040a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4140.0000.4130.0000.4120.0000.4110.0000.4100.0000
      !>  (addvr:lms mr 4 vr)
  ==
++  test-subvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .5 .8 .1.1e1 .1.4e1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (subvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.4000.0000.40a0.0000.4100.0000.4130.0000.4160.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4150.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (subvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.4e1 .1.7e1 .2e1 .2.3e1 .2.6e1]])
      !>  (subvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4160.0000.4188.0000.41a0.0000.41b8.0000.41d0.0000
      !>  (subvr:lms mr 4 vr)
  ==
++  test-mulvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.-1 .-6 .-1.5e1 .-2.8e1 .-4.5e1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (mulvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.bf80.0000.c0c0.0000.c170.0000.c1e0.0000.c234.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4150.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (mulvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.-1.3e1 .-4.2e1 .-7.5e1 .-1.12e2 .-1.53e2]])
      !>  (mulvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.c150.0000.c228.0000.c296.0000.c2e0.0000.c319.0000
      !>  (mulvr:lms mr 4 vr)
  ==
++  test-divvr
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.-1 .-6.666666e-1 .-5.9999996e-1 .-5.7142854e-1 .-5.555555e-1] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.1.3e1 .1.4e1 .1.5e1 .1.6e1 .1.7e1]])
      !>  (divvr:lms mr 1 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.bf80.0000.bf2a.aaaa.bf19.9999.bf12.4924.bf0e.38e3.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.4150.0000.4160.0000.4170.0000.4180.0000.4188.0000
      !>  (divvr:lms mr 1 vr)
    %+  expect-eq
      !>  (make:lms ~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .1e1 .1.1e1 .1.2e1 .1.3e1] ~[.-1.3e1 .-4.6666665 .-3 .-2.2857141 .-1.8888888]])
      !>  (divvr:lms mr 4 vr)
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4000.0000.4040.0000.4080.0000.40a0.0000.40a0.0000.40c0.0000.40e0.0000.4100.0000.4110.0000.4110.0000.4120.0000.4130.0000.4140.0000.4150.0000.c150.0000.c095.5555.c040.0000.c012.4924.bff1.c71c
      !>  (divvr:lms mr 4 vr)
  ==
++  test-addm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.2 .4 .6 .8 .1e1] ~[.1e1 .1.2e1 .1.4e1 .1.6e1 .1.8e1] ~[.1.8e1 .2e1 .2.2e1 .2.4e1 .2.6e1] ~[.2.6e1 .2.8e1 .3e1 .3.2e1 .3.4e1]])
      !>  (addm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.4000.0000.4080.0000.40c0.0000.4100.0000.4120.0000.4120.0000.4140.0000.4160.0000.4180.0000.4190.0000.4190.0000.41a0.0000.41b0.0000.41c0.0000.41d0.0000.41d0.0000.41e0.0000.41f0.0000.4200.0000.4208.0000
      !>  (addm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-subm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0] ~[.0 .0 .0 .0 .0]])
      !>  (subm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.0000.000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0.0000.
      !>  (subm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mulm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .4 .9 .1.6e1 .2.5e1] ~[.2.5e1 .3.6e1 .4.9e1 .6.4e1 .8.1e1] ~[.8.1e1 .1e2 .1.21e2 .1.44e2 .1.69e2] ~[.1.69e2 .1.96e2 .2.25e2 .2.56e2 .2.89e2]])
      !>  (mulm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.4080.0000.4110.0000.4180.0000.41c8.0000.41c8.0000.4210.0000.4244.0000.4280.0000.42a2.0000.42a2.0000.42c8.0000.42f2.0000.4310.0000.4329.0000.4329.0000.4344.0000.4361.0000.4380.0000.4390.8000
      !>  (mulm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-divm
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mmul :: TODO
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==
++  test-mpow  :: TODO
  ;:  weld
    %+  expect-eq
      !>  (make:lms ~[~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1] ~[.1 .1 .1 .1 .1]])
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
    %+  expect-eq
      !>  `@lms`0x5.0004.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000.3f80.0000
      !>  (divm:lms (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]) (make:lms `(list (list @rs))`~[~[.1 .2 .3 .4 .5] ~[.5 .6 .7 .8 .9] ~[.9 .10 .11 .12 .13] ~[.13 .14 .15 .16 .17]]))
  ==


++  test-trace  !!
++  test-submatrix  !!
++  test-augment  !!
++  test-minor  !!

++  test-invert  !!
--
